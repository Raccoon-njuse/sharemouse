# ShareMouse

一个简单而强大的工具，用于在同一局域网内的多台计算机之间共享鼠标、键盘和剪贴板。

## 功能特性

- 🖱️ **鼠标共享**：使用一个鼠标控制多台计算机
- ⌨️ **键盘共享**：在所有连接的设备上使用同一个键盘
- 📋 **剪贴板同步**：在计算机之间无缝共享剪贴板内容
- ⚡ **低延迟**：快速响应的远程控制
- 🔄 **服务器-客户端架构**：简单的设置，明确的角色分工
- 🖥️ **跨平台**：支持 Windows 和 macOS
- 🛡️ **安全**：仅在本地网络内通信
- 🎯 **鼠标滚轮反转**：支持水平和垂直滚轮方向反转，实现自然滚动

## 系统要求

- Python 3.7 或更高版本
- 依赖库：
  - `pynput` - 用于捕获和注入输入事件
  - `pyperclip` - 用于剪贴板管理

## 安装步骤

1. 克隆或下载此仓库
2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

## 使用方法

ShareMouse 有两种运行模式：**服务器**（主机）和**客户端**（客户机）。

### 服务器模式

服务器是控制其他设备的计算机。运行：

```bash
python main.py --mode server 
```

默认情况下，服务器监听所有网络接口 (`0.0.0.0`) 和端口 `5001`。

#### 自定义服务器配置

```bash
python main.py --mode server --host 192.168.1.100 --port 5001
```

##### 鼠标滚轮反转

您可以使用以下参数反转鼠标滚轮方向（默认值为 on）：

```bash
# 使用默认设置（on）
python main.py --mode server

# 关闭水平滚轮反转
python main.py --mode server --invert-scroll-x off

# 关闭垂直滚轮反转
python main.py --mode client --host <服务器IP> --invert-scroll-y off

# 同时关闭水平和垂直滚轮反转
python main.py --mode server --invert-scroll-x off --invert-scroll-y off

# 明确指定开启水平滚轮反转
python main.py --mode server --invert-scroll-x on
```

### 客户端模式

客户端由服务器控制。运行：

```bash
python main.py --mode client --host <服务器IP地址>
```

将 `<服务器IP地址>` 替换为服务器计算机的实际 IP 地址。

#### 自定义客户端配置

```bash
python main.py --mode client --host 192.168.1.100 --port 5001
```

## 快捷键

- **鼠标中键**（仅服务器）：切换远程控制的开启/关闭

## 工作原理

1. **服务器设置**：服务器开始监听客户端的连接请求
2. **客户端连接**：客户端连接到服务器
3. **控制切换**：服务器按下 Ctrl+Alt+S 激活远程控制
4. **事件捕获**：服务器捕获本地鼠标/键盘事件
5. **网络传输**：事件通过 TCP 发送到客户端
6. **事件注入**：客户端将接收到的事件注入到本地系统
7. **剪贴板同步**：剪贴板内容在设备之间自动同步

## 架构设计

### 核心模块

- **ShareMouseApp**：主应用程序协调器
- **NetworkManager**：处理 TCP 连接和数据传输
- **InputHandler**：捕获和注入输入事件
- **ClipboardManager**：监控和同步剪贴板内容
- **Utils**：辅助函数和日志记录

### 数据流程

```
服务器: 输入 → 捕获 → 网络 → 客户端: 网络 → 注入 → 系统
```

## 安全性

- 使用 TCP 进行可靠通信
- 无需外部网络访问
- 仅在本地网络内运行
- 敏感数据不会存储或传输到本地网络之外

## 故障排除

### 服务器问题
- **无客户端连接**：确保两台设备在同一网络
- **鼠标中键不工作**：检查是否有其他应用程序占用了鼠标中键功能，或确保应用程序有捕获输入的必要权限
- **权限错误**：确保应用程序有捕获输入的必要权限

### 客户端问题
- **连接失败**：验证服务器 IP 地址和端口是否正确
- **输入延迟**：减少网络拥塞或尝试有线连接

## 开发指南

### 贡献代码

1. Fork 此仓库
2. 创建功能分支
3. 进行更改
4. 提交拉取请求

### 代码风格

- 遵循 PEP 8 规范
- 使用清晰描述性的变量名
- 为复杂逻辑添加注释
- 为新功能编写测试

### 测试

运行基本功能测试：

```bash
# 测试服务器模式
python main.py --mode server

# 测试客户端模式（在另一个终端）
python main.py --mode client --host xxx --port 5001
```

## 许可证

MIT 许可证 - 您可以自由地将此项目用于个人或商业目的。

## 版本历史

- **v1.1**：新增鼠标滚轮反转功能
  - 添加 `--invert-scroll-x` 参数反转水平滚轮方向
  - 添加 `--invert-scroll-y` 参数反转垂直滚轮方向（自然滚动）
  - 支持服务器和客户端独立配置

- **v1.0**：初始版本，支持鼠标、键盘和剪贴板共享

## 免责声明

此工具仅供个人使用。使用风险自负。请始终确保您有控制所连接计算机的必要权限。